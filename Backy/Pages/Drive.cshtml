@page
@model Backy.Pages.DriveModel
@{
    ViewData["Title"] = "Drive Catalog";
}

<h1>@ViewData["Title"]</h1>

<div class="container">
    <div class="row">

        <div id="loading-spinner" class="spinner-overlay" style="display: none;">
            <div class="spinner-border text-warning" role="status">
                <span class="sr-only">Loading...</span>
            </div>
        </div>

        <!-- Display mirror groups first -->
        @foreach (var group in Model.MirrorGroups)
        {
            <div class="col-12">
                <div class="card mb-4">
                    <div class="card-header bg-info text-white">
                        <h5>Mirror Group: @group.GroupLabel</h5>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            @foreach (var drive in group.Drives)
                            {
                                <div class="col-md-4 d-flex justify-content-center mb-3">
                                    @await Html.PartialAsync("_DriveCard", drive)
                                </div>
                            }
                        </div>
                    </div>
                </div>
            </div>
        }

        <!-- Display standalone drives -->
        @foreach (var drive in Model.StandaloneDrives)
        {
            <div class="col-md-4 d-flex justify-content-center mb-3">
                @await Html.PartialAsync("_DriveCard", drive)
            </div>
        }
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function () {
    @foreach (var drive in Model.StandaloneDrives)
    {
        <text>
                    document.getElementById('used-size-@drive.UUID').textContent = formatSize(@drive.UsedSpace);
                    document.getElementById('total-size-@drive.UUID').textContent = formatSize(@drive.PartitionSize);
                    document.getElementById('total-size-@drive.UUID-bottom').textContent = formatSize(@drive.PartitionSize);
        </text>
        ;
    }
    });
</script>


<script src="/js/Index.js"></script>

<!-- Link to external CSS file -->
<link rel="stylesheet" href="/css/Index.css">
